<div class="dog-profile-card">

  <div class="first-links">
    <div class="d-flex justify-content-between w-100 align-items-center">
      <%= link_to household_dogs_path(current_user.household), class: "text-decoration-none text-muted" do %>
        <i class="fa-solid fa-arrow-left me-1"></i> All Dogs
      <% end %>
      <div class="edit-link">
        <%= link_to edit_dog_path(@dog), class: "edit-btn" do %>
          <i class="fa-regular fa-pen-to-square"></i>
        <% end %>
      </div>
    </div>
  </div>

  <h1 class="dog-name mt-3"><%= @dog.name %></h1>

  <div class="dog-photo">
    <% if @dog.photo.attached? %>
      <%= image_tag @dog.photo, alt: @dog.name %>
    <% else %>
      <%= image_tag "pawprint.jpg", alt: "No photo available" %>
    <% end %>
  </div>
  </div>


  <div class="dog-profile-card2">
  <div class="dog-info-tabs">
    <ul class="nav nav-tabs" id="dogInfoTabs" role="tablist">
      <li class="nav-item" role="presentation">
        <button class="nav-link active" id="info-tab" data-bs-toggle="tab" data-bs-target="#info" type="button" role="tab" aria-controls="info" aria-selected="true">
          <i class="fa-solid fa-circle-info me-1"></i> Info
        </button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="medical-tab" data-bs-toggle="tab" data-bs-target="#medical" type="button" role="tab" aria-controls="medical" aria-selected="false">
          <i class="fa-solid fa-stethoscope me-1"></i> Medical
        </button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="insurance-tab" data-bs-toggle="tab" data-bs-target="#insurance" type="button" role="tab" aria-controls="insurance" aria-selected="false">
          <i class="fa-solid fa-shield-halved me-1"></i> Insurance
        </button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="notes-tab" data-bs-toggle="tab" data-bs-target="#notes" type="button" role="tab" aria-controls="notes" aria-selected="false">
          <i class="fa-solid fa-note-sticky me-1"></i> Notes
        </button>
      </li>
    </ul>

    <div class="tab-content" id="dogInfoTabsContent">
      <!-- Info Tab -->
      <div class="tab-pane fade show active" id="info" role="tabpanel" aria-labelledby="info-tab">
        <div class="dog-info">
          <p><strong>Breed:</strong> <%= @dog.breed.present? ? @dog.breed : "Not specified" %></p>
          <p><strong>Gender:</strong> <%= @dog.gender.present? ? @dog.gender : "Not specified" %></p>
          <p><strong>Weight:</strong> <%= @dog.weight.present? ? "#{@dog.weight} kg" : "Not specified" %></p>
          <p><strong>Date of birth:</strong> <%= @dog.dob.present? ? @dog.dob.strftime("%d %b %Y") : "Not specified" %></p>
          <% if @dog.microchip_number.present? %>
            <p><strong>Microchip #:</strong> <%= @dog.microchip_number %></p>
          <% end %>
        </div>
      </div>

      <!-- Medical Tab -->
      <div class="tab-pane fade" id="medical" role="tabpanel" aria-labelledby="medical-tab">
        <div class="dog-info">
          <% if @dog.vet_name.present? || @dog.vet_clinic.present? || @dog.vet_phone.present? || @dog.vet_address.present? || @dog.allergies.present? || @dog.medications.present? %>
            <% if @dog.vet_name.present? %>
              <p><strong>Vet Name:</strong> <%= @dog.vet_name %></p>
            <% end %>
            <% if @dog.vet_clinic.present? %>
              <p><strong>Vet Clinic:</strong> <%= @dog.vet_clinic %></p>
            <% end %>
            <% if @dog.vet_phone.present? %>
              <p><strong>Vet Phone:</strong> <%= @dog.vet_phone %></p>
            <% end %>
            <% if @dog.vet_address.present? %>
              <p><strong>Vet Address:</strong> <%= @dog.vet_address %></p>
            <% end %>
            <% if @dog.allergies.present? %>
              <p><strong>Allergies:</strong> <%= @dog.allergies %></p>
            <% end %>
            <% if @dog.medications.present? %>
              <p><strong>Medications:</strong> <%= @dog.medications %></p>
            <% end %>
          <% else %>
            <p class="text-muted">No medical information added yet.</p>
          <% end %>
        </div>
      </div>

      <!-- Insurance Tab -->
      <div class="tab-pane fade" id="insurance" role="tabpanel" aria-labelledby="insurance-tab">
        <div class="dog-info">
          <% if @dog.insurance_provider.present? || @dog.insurance_policy_number.present? %>
            <% if @dog.insurance_provider.present? %>
              <p><strong>Insurance Provider:</strong> <%= @dog.insurance_provider %></p>
            <% end %>
            <% if @dog.insurance_policy_number.present? %>
              <p><strong>Policy #:</strong> <%= @dog.insurance_policy_number %></p>
            <% end %>
          <% else %>
            <p class="text-muted">No insurance information added yet.</p>
          <% end %>
        </div>
      </div>

      <!-- Notes Tab -->
      <div class="tab-pane fade" id="notes" role="tabpanel" aria-labelledby="notes-tab">
        <div class="dog-info">
          <% if @dog.special_notes.present? %>
            <p><%= @dog.special_notes %></p>
          <% else %>
            <p class="text-muted">No special notes added yet.</p>
          <% end %>
        </div>
      </div>
    </div>
  </div>

  <div class="share-btn">
    <div class="mb-2">
      <%= link_to new_dog_shareable_profile_path(@dog), class: "btn btn-primary mb-2" do %>
         Share <i class="fa-regular fa-share-from-square ms-2"></i>
      <% end %>

      <% if @dog.current_share_profile %>
        <%= link_to dog_shareable_profile_path(@dog, @dog.current_share_profile),
                    class: "btn btn-success" do %>
          <i class="bi bi-link"></i> View Active Share Link
        <% end %>
      <% end %>
      </div>
    </div>
  </div>
